# localhost with PHP 7
server {
    listen 80;
    server_name localhost7;
    client_max_body_size 108M;
    index index.php index.html;

    error_log  /var/log/nginx/error.log;
    access_log /var/log/nginx/access.log;
    root /application;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php70:9000;
    }

    location ~ /\.ht {
        deny all;
    }

    location ~ /.well-known {
        allow all;
    }
}



# CR3
server {
    listen 80;
    server_name cr3-new;
    client_max_body_size 108M;
    index index.php index.html;

    error_log  /application/cr3-default/tmp/logs/error.log;
    access_log /application/cr3-default/tmp/logs/access.log;
    root /application/cr3-default;

    location / {
        try_files $uri /docroot/$uri /docroot/index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php70:9000;
    }

    location /app {
        alias /application/cr3-default/application;
    }

    location /cad_js {
        alias /application/cr3-default/lib/Scripts;
    }

    location /ssoview {
        alias /application/cr3-default/lib/Tools/simplesamlphp/rschool/sso-client-lib/www;
    }

    location /samlrschool {
        alias /application/cr3-default/lib/Tools/simplesamlphp/rschool/sso-client-lib/libraries/simplesamlphp/www;
    }

    location /yui {
        alias /application/cr3-default/lib/Scripts/Yui/build;
    }

    location /cad_clients {
        alias /application/cr3-default/clients;
    }

    location /lib {
        alias /application/cr3-default/lib;
    }

    location ~ /\.ht {
        deny all;
    }

    location ~ /.well-known {
        allow all;
    }
}




# localhost with PHP5
server {
    listen 80;
    server_name localhost5;
    client_max_body_size 108M;
    index index.php index.html;

    error_log  /var/log/nginx/error.log;
    access_log /var/log/nginx/access.log;
    root /application;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }

    location ~ /\.ht {
        deny all;
    }

    location ~ /.well-known {
        allow all;
    }
}



# ESCHOOL
server {
    listen 80;
    server_name eschool;

    root /application/e-school;
    index index.html index.php;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}


# AJI
server {
    listen 80;
    server_name aji.me;

    root /application/aji;
    index index.html index.php;

    error_log  /application/aji/logs/error.log;
    access_log /application/aji/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}



# Daily Meal
server {
    listen 80;
    server_name dailymeal.me;

    root /application/dailymeal;
    index index.html index.php;

    error_log  /application/dailymeal/logs/error.log;
    access_log /application/dailymeal/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}


# BACKLINKAN
server {
    listen 80;
    server_name backlinkan.me;

    root /application/backlinkan;
    index index.html index.php;

    error_log  /application/backlinkan/logs/error.log;
    access_log /application/backlinkan/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}

# CAHAYA NET
server {
    listen 80;
    server_name cahayanet.me;

    root /application/cahaya-net;
    index index.html index.php;

    error_log  /application/cahaya-net/logs/error.log;
    access_log /application/cahaya-net/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
        # Check if a file or directory index file exists, else route it to index.php.
        try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}


server {
    listen 80;
    server_name hellobasic.me;

    root /application/hellobasic;
    index index.html index.php;

    error_log  /application/hellobasic/logs/error.log;
    access_log /application/hellobasic/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
        # Check if a file or directory index file exists, else route it to index.php.
        try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}


# FACEOFME
server {
    listen 80;
    server_name faceofme;

    root /application/faceofme;
    index index.html index.php;

    error_log  /application/faceofme/logs/error.log;
    access_log /application/faceofme/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}

# INVENTORY
server {
    listen 80;
    server_name my-inventory;

    root /application/inventory;
    index index.html index.php;

    error_log  /application/inventory/logs/error.log;
    access_log /application/inventory/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}

#keuangan
server {
    listen 80;
    server_name app-keuangan;

    root /application/keuangan;
    index index.html index.php;

    error_log  /application/keuangan/logs/error.log;
    access_log /application/keuangan/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}


#local test
server {
    listen 80;
    server_name local-test;

    root /application/local-test/;
    index index.html index.php;

    error_log  /application/local-test/logs/error.log;
    access_log /application/local-test/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php70:9000;
    }
}


#UMKM TEST

server {
    listen 80;
    server_name umkm.test;

    root /application/umkm;
    index index.html index.php;

    error_log  /application/umkm/logs/error.log;
    access_log /application/umkm/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}

server {
    listen 80;
    server_name umkm2.test;

    root /application/umkm;
    index index.html index.php;

    error_log  /application/umkm/logs/error.log;
    access_log /application/umkm/logs/access.log;

    # set expiration of assets to MAX for caching
    location ~* \.(ico|css|js|gif|jpe?g|png)(\?[0-9]+)?$ {
            expires max;
            log_not_found off;
    }

    location / {
            # Check if a file or directory index file exists, else route it to index.php.
            try_files $uri $uri/ /index.php;
    }

    location ~* \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }
}




# CR3
server {
    listen 80;
    server_name cr3;
    client_max_body_size 108M;
    index index.php index.html;

    error_log  /application/cr3-live/tmp/logs/error.log;
    access_log /application/cr3-live/tmp/logs/access.log;
    root /application/cr3-live;

    location / {
        try_files $uri /docroot/$uri /docroot/index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }

    location /app {
        alias /application/cr3-live/application;
    }

    location /cad_js {
        alias /application/cr3-live/lib/Scripts;
    }

    location /ssoview {
        alias /application/cr3-live/lib/Tools/simplesamlphp/rschool/sso-client-lib/www;
    }

    location /samlrschool {
        alias /application/cr3-live/lib/Tools/simplesamlphp/rschool/sso-client-lib/libraries/simplesamlphp/www;
    }

    location /yui {
        alias /application/cr3-live/lib/Scripts/Yui/build;
    }

    location /cad_clients {
        alias /application/cr3-live/clients;
    }

    location /lib {
        alias /application/cr3-live/lib;
    }

    location ~ /\.ht {
        deny all;
    }

    location ~ /.well-known {
        allow all;
    }
}

# CR3 MASTER
server {
    listen 80;
    server_name cr3-master;
    client_max_body_size 108M;
    index index.php index.html;

    error_log  /application/cr3-master/tmp/logs/error.log;
    access_log /application/cr3-master/tmp/logs/access.log;
    root /application/cr3-master;

    location / {
        try_files $uri /docroot/$uri /docroot/index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
    }

    location /app {
        alias /application/cr3-master/application;
    }

    location /cad_js {
        alias /application/cr3-master/lib/Scripts;
    }

    location /ssoview {
        alias /application/cr3-master/lib/Tools/simplesamlphp/rschool/sso-client-lib/www;
    }

    location /samlrschool {
        alias /application/cr3-master/lib/Tools/simplesamlphp/rschool/sso-client-lib/libraries/simplesamlphp/www;
    }

    location /yui {
        alias /application/cr3-master/lib/Scripts/Yui/build;
    }

    location /cad_clients {
        alias /application/cr3-master/clients;
    }

    location /lib {
        alias /application/cr3-master/lib;
    }

    location ~ /\.ht {
        deny all;
    }

    location ~ /.well-known {
        allow all;
    }
}

# CR-MNSCU
server {
    listen 80;
    server_name cr3-mnscu;
    client_max_body_size 108M;
    index index.php index.html;

    error_log  /application/cr3-mnscu/tmp/logs/error.log;
    access_log /application/cr3-mnscu/tmp/logs/access.log;
    root /application/cr3-mnscu;

    location / {
        try_files $uri /docroot/$uri /docroot/index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
        fastcgi_pass php5:9000;
        fastcgi_read_timeout 1200;
    }

    location /app {
        alias /application/cr3-mnscu/application;
    }

    location /cad_js {
        alias /application/cr3-mnscu/lib/Scripts;
    }

    location /ssoview {
        alias /application/cr3-mnscu/lib/Tools/simplesamlphp/rschool/sso-client-lib/www;
    }

    location /samlrschool {
        alias /application/cr3-mnscu/lib/Tools/simplesamlphp/rschool/sso-client-lib/libraries/simplesamlphp/www;
    }

    location /yui {
        alias /application/cr3-mnscu/lib/Scripts/Yui/build;
    }

    location /cad_clients {
        alias /application/cr3-mnscu/clients;
    }

    location /lib {
        alias /application/cr3-mnscu/lib;
    }

    location ~ /\.ht {
        deny all;
    }

    location ~ /.well-known {
        allow all;
    }
}


server {
    listen 80;
    server_name crmonolith.devel;
    root /application/cr3-monolith/public;

    error_log  /var/log/nginx/error.log;
    access_log /var/log/nginx/access.log;

    location / {
        # try to serve file directly, fallback to index.php
        try_files $uri /index.php$is_args$args;
    }

    location ~ ^/index\.php(/|$) {

                proxy_buffer_size   128k;
                proxy_buffers   4 256k;
                proxy_busy_buffers_size   256k;
                proxy_read_timeout 3600;
                fastcgi_split_path_info ^(.+\.php)(/.*)$;
                index  index.php app_dev.php;
                fastcgi_index  index.php;
                fastcgi_read_timeout 240;
                fastcgi_pass  sf-modular-php8:9000;
                include fastcgi_params;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                fastcgi_param SERVER_NAME $http_host;
                fastcgi_param PATH_INFO $fastcgi_script_name;
                fastcgi_ignore_client_abort on;
                fastcgi_buffers 8 16k;
                fastcgi_buffer_size 32k;
                client_max_body_size 20m;
                client_body_buffer_size 128k;
                internal;
    }

    # return 404 for all other php files not matching the front controller
    # this prevents access to other php files you don't want to be accessible.
    location ~ \.php$ {
        return 404;
    }

    location ~ /\.ht {
        deny all;
    }
}
